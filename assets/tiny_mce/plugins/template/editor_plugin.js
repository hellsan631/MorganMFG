!function(){var a=tinymce.each;tinymce.create("tinymce.plugins.TemplatePlugin",{init:function(b,c){var d=this;d.editor=b,b.addCommand("mceTemplate",function(){b.windowManager.open({file:c+"/template.htm",width:b.getParam("template_popup_width",750),height:b.getParam("template_popup_height",600),inline:1},{plugin_url:c})}),b.addCommand("mceInsertTemplate",d._insertTemplate,d),b.addButton("template",{title:"template.desc",cmd:"mceTemplate"}),b.onPreProcess.add(function(b,c){var e=b.dom;a(e.select("div",c.node),function(c){e.hasClass(c,"mceTmpl")&&(a(e.select("*",c),function(a){e.hasClass(a,b.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(a.innerHTML=d._getDateTime(new Date,b.getParam("template_mdate_format",b.getLang("template.mdate_format"))))}),d._replaceVals(c))})})},getInfo:function(){return{longname:"Template plugin",author:"Moxiecode Systems AB",authorurl:"http://www.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/template",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_insertTemplate:function(b,c){function d(a,b){return new RegExp("\\b"+b+"\\b","g").test(a.className)}var e,f,g=this,h=g.editor,i=h.dom,j=h.selection.getContent();e=c.content,a(g.editor.getParam("template_replace_values"),function(a,b){"function"!=typeof a&&(e=e.replace(new RegExp("\\{\\$"+b+"\\}","g"),a))}),f=i.create("div",null,e),n=i.select(".mceTmpl",f),n&&n.length>0&&(f=i.create("div",null),f.appendChild(n[0].cloneNode(!0))),a(i.select("*",f),function(a){d(a,h.getParam("template_cdate_classes","cdate").replace(/\s+/g,"|"))&&(a.innerHTML=g._getDateTime(new Date,h.getParam("template_cdate_format",h.getLang("template.cdate_format")))),d(a,h.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(a.innerHTML=g._getDateTime(new Date,h.getParam("template_mdate_format",h.getLang("template.mdate_format")))),d(a,h.getParam("template_selected_content_classes","selcontent").replace(/\s+/g,"|"))&&(a.innerHTML=j)}),g._replaceVals(f),h.execCommand("mceInsertContent",!1,f.innerHTML),h.addVisual()},_replaceVals:function(b){var c=this.editor.dom,d=this.editor.getParam("template_replace_values");a(c.select("*",b),function(b){a(d,function(a,e){c.hasClass(b,e)&&"function"==typeof d[e]&&d[e](b)})})},_getDateTime:function(a,b){function c(a,b){var c;if(a=""+a,a.length<b)for(c=0;c<b-a.length;c++)a="0"+a;return a}return b?(b=b.replace("%D","%m/%d/%y"),b=b.replace("%r","%I:%M:%S %p"),b=b.replace("%Y",""+a.getFullYear()),b=b.replace("%y",""+a.getYear()),b=b.replace("%m",c(a.getMonth()+1,2)),b=b.replace("%d",c(a.getDate(),2)),b=b.replace("%H",""+c(a.getHours(),2)),b=b.replace("%M",""+c(a.getMinutes(),2)),b=b.replace("%S",""+c(a.getSeconds(),2)),b=b.replace("%I",""+((a.getHours()+11)%12+1)),b=b.replace("%p",""+(a.getHours()<12?"AM":"PM")),b=b.replace("%B",""+this.editor.getLang("template_months_long").split(",")[a.getMonth()]),b=b.replace("%b",""+this.editor.getLang("template_months_short").split(",")[a.getMonth()]),b=b.replace("%A",""+this.editor.getLang("template_day_long").split(",")[a.getDay()]),b=b.replace("%a",""+this.editor.getLang("template_day_short").split(",")[a.getDay()]),b=b.replace("%%","%")):""}}),tinymce.PluginManager.add("template",tinymce.plugins.TemplatePlugin)}();
//# sourceMappingURL=editor_plugin.map