!function(){var a=tinymce.DOM,b=tinymce.dom.Element,c=tinymce.dom.Event,d=tinymce.each,e=tinymce.is;tinymce.create("tinymce.plugins.InlinePopups",{init:function(b,c){b.onBeforeRenderUI.add(function(){b.windowManager=new tinymce.InlineWindowManager(b),a.loadCSS(c+"/skins/"+(b.settings.inlinepopups_skin||"clearlooks2")+"/window.css")})},getInfo:function(){return{longname:"InlinePopups",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/inlinepopups",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.create("tinymce.InlineWindowManager:tinymce.WindowManager",{InlineWindowManager:function(a){var b=this;b.parent(a),b.zIndex=3e5,b.count=0,b.windows={}},open:function(d,e){var f,g,h,i,j,k,l,m=this,n="",o=m.editor,p=0,q=0;return d=d||{},e=e||{},d.inline?(l=m._frontWindow(),l&&a.get(l.id+"_ifr")&&(l.focussedElement=a.get(l.id+"_ifr").contentWindow.document.activeElement),d.type||(m.bookmark=o.selection.getBookmark(1)),f=a.uniqueId(),g=a.getViewPort(),d.width=parseInt(d.width||320),d.height=parseInt(d.height||240)+(tinymce.isIE?8:0),d.min_width=parseInt(d.min_width||150),d.min_height=parseInt(d.min_height||100),d.max_width=parseInt(d.max_width||2e3),d.max_height=parseInt(d.max_height||2e3),d.left=d.left||Math.round(Math.max(g.x,g.x+g.w/2-d.width/2)),d.top=d.top||Math.round(Math.max(g.y,g.y+g.h/2-d.height/2)),d.movable=d.resizable=!0,e.mce_width=d.width,e.mce_height=d.height,e.mce_inline=!0,e.mce_window_id=f,e.mce_auto_focus=d.auto_focus,m.features=d,m.params=e,m.onOpen.dispatch(m,d,e),d.type&&(n+=" mceModal",d.type&&(n+=" mce"+d.type.substring(0,1).toUpperCase()+d.type.substring(1)),d.resizable=!1),d.statusbar&&(n+=" mceStatusbar"),d.resizable&&(n+=" mceResizable"),d.minimizable&&(n+=" mceMinimizable"),d.maximizable&&(n+=" mceMaximizable"),d.movable&&(n+=" mceMovable"),m._addAll(a.doc.body,["div",{id:f,role:"dialog","aria-labelledby":d.type?f+"_content":f+"_title","class":(o.settings.inlinepopups_skin||"clearlooks2")+(tinymce.isIE&&window.getSelection?" ie9":""),style:"width:100px;height:100px"},["div",{id:f+"_wrapper","class":"mceWrapper"+n},["div",{id:f+"_top","class":"mceTop"},["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:f+"_title"},d.title||""]],["div",{id:f+"_middle","class":"mceMiddle"},["div",{id:f+"_left","class":"mceLeft",tabindex:"0"}],["span",{id:f+"_content"}],["div",{id:f+"_right","class":"mceRight",tabindex:"0"}]],["div",{id:f+"_bottom","class":"mceBottom"},["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:f+"_status"},"Content"]],["a",{"class":"mceMove",tabindex:"-1",href:"javascript:;"}],["a",{"class":"mceMin",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMax",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMed",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceClose",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{id:f+"_resize_n","class":"mceResize mceResizeN",tabindex:"-1",href:"javascript:;"}],["a",{id:f+"_resize_s","class":"mceResize mceResizeS",tabindex:"-1",href:"javascript:;"}],["a",{id:f+"_resize_w","class":"mceResize mceResizeW",tabindex:"-1",href:"javascript:;"}],["a",{id:f+"_resize_e","class":"mceResize mceResizeE",tabindex:"-1",href:"javascript:;"}],["a",{id:f+"_resize_nw","class":"mceResize mceResizeNW",tabindex:"-1",href:"javascript:;"}],["a",{id:f+"_resize_ne","class":"mceResize mceResizeNE",tabindex:"-1",href:"javascript:;"}],["a",{id:f+"_resize_sw","class":"mceResize mceResizeSW",tabindex:"-1",href:"javascript:;"}],["a",{id:f+"_resize_se","class":"mceResize mceResizeSE",tabindex:"-1",href:"javascript:;"}]]]),a.setStyles(f,{top:-1e4,left:-1e4}),tinymce.isGecko&&a.setStyle(f,"overflow","auto"),d.type||(p+=a.get(f+"_left").clientWidth,p+=a.get(f+"_right").clientWidth,q+=a.get(f+"_top").clientHeight,q+=a.get(f+"_bottom").clientHeight),a.setStyles(f,{top:d.top,left:d.left,width:d.width+p,height:d.height+q}),k=d.url||d.file,k&&(tinymce.relaxedDomain&&(k+=(-1==k.indexOf("?")?"?":"&")+"mce_rdomain="+tinymce.relaxedDomain),k=tinymce._addVer(k)),d.type?(a.add(f+"_wrapper","a",{id:f+"_ok","class":"mceButton mceOk",href:"javascript:;",onmousedown:"return false;"},"Ok"),"confirm"==d.type&&a.add(f+"_wrapper","a",{"class":"mceButton mceCancel",href:"javascript:;",onmousedown:"return false;"},"Cancel"),a.add(f+"_middle","div",{"class":"mceIcon"}),a.setHTML(f+"_content",d.content.replace("\n","<br />")),c.add(f,"keyup",function(a){var b=27;return a.keyCode===b?(d.button_func(!1),c.cancel(a)):void 0}),c.add(f,"keydown",function(b){var d,e=9;return b.keyCode===e?(d=a.select("a.mceCancel",f+"_wrapper")[0],d&&d!==b.target?d.focus():a.get(f+"_ok").focus(),c.cancel(b)):void 0})):(a.add(f+"_content","iframe",{id:f+"_ifr",src:'javascript:""',frameBorder:0,style:"border:0;width:10px;height:10px"}),a.setStyles(f+"_ifr",{width:d.width,height:d.height}),a.setAttrib(f+"_ifr","src",k)),h=c.add(f,"mousedown",function(b){var d,e,g=b.target;if(d=m.windows[f],m.focus(f),"A"==g.nodeName||"a"==g.nodeName){if("mceClose"==g.className)return m.close(null,f),c.cancel(b);if("mceMax"==g.className)d.oldPos=d.element.getXY(),d.oldSize=d.element.getSize(),e=a.getViewPort(),e.w-=2,e.h-=2,d.element.moveTo(e.x,e.y),d.element.resizeTo(e.w,e.h),a.setStyles(f+"_ifr",{width:e.w-d.deltaWidth,height:e.h-d.deltaHeight}),a.addClass(f+"_wrapper","mceMaximized");else if("mceMed"==g.className)d.element.moveTo(d.oldPos.x,d.oldPos.y),d.element.resizeTo(d.oldSize.w,d.oldSize.h),d.iframeElement.resizeTo(d.oldSize.w-d.deltaWidth,d.oldSize.h-d.deltaHeight),a.removeClass(f+"_wrapper","mceMaximized");else{if("mceMove"==g.className)return m._startDrag(f,b,g.className);if(a.hasClass(g,"mceResize"))return m._startDrag(f,b,g.className.substring(13))}}}),i=c.add(f,"click",function(a){var b=a.target;if(m.focus(f),"A"==b.nodeName||"a"==b.nodeName)switch(b.className){case"mceClose":return m.close(null,f),c.cancel(a);case"mceButton mceOk":case"mceButton mceCancel":return d.button_func("mceButton mceOk"==b.className),c.cancel(a)}}),c.add([f+"_left",f+"_right"],"focus",function(b){var c=a.get(f+"_ifr");if(c){var d=c.contentWindow.document.body,e=a.select(":input:enabled,*[tabindex=0]",d);b.target.id===f+"_left"?e[e.length-1].focus():e[0].focus()}else a.get(f+"_ok").focus()}),j=m.windows[f]={id:f,mousedown_func:h,click_func:i,element:new b(f,{blocker:1,container:o.getContainer()}),iframeElement:new b(f+"_ifr"),features:d,deltaWidth:p,deltaHeight:q},j.iframeElement.on("focus",function(){m.focus(f)}),0==m.count&&"modal"==m.editor.getParam("dialog_type","modal")?(a.add(a.doc.body,"div",{id:"mceModalBlocker","class":(m.editor.settings.inlinepopups_skin||"clearlooks2")+"_modalBlocker",style:{zIndex:m.zIndex-1}}),a.show("mceModalBlocker"),a.setAttrib(a.doc.body,"aria-hidden","true")):a.setStyle("mceModalBlocker","z-index",m.zIndex-1),(tinymce.isIE6||/Firefox\/2\./.test(navigator.userAgent)||tinymce.isIE&&!a.boxModel)&&a.setStyles("mceModalBlocker",{position:"absolute",left:g.x,top:g.y,width:g.w-2,height:g.h-2}),a.setAttrib(f,"aria-hidden","false"),m.focus(f),m._fixIELayout(f,1),a.get(f+"_ok")&&a.get(f+"_ok").focus(),m.count++,j):m.parent(d,e)},focus:function(b){var c,d=this;(c=d.windows[b])&&(c.zIndex=this.zIndex++,c.element.setStyle("zIndex",c.zIndex),c.element.update(),b+="_wrapper",a.removeClass(d.lastId,"mceFocus"),a.addClass(b,"mceFocus"),d.lastId=b,c.focussedElement?c.focussedElement.focus():a.get(b+"_ok")?a.get(c.id+"_ok").focus():a.get(c.id+"_ifr")&&a.get(c.id+"_ifr").focus())},_addAll:function(a,b){var c,d=this,f=tinymce.DOM;if(e(b,"string"))a.appendChild(f.doc.createTextNode(b));else if(b.length)for(a=a.appendChild(f.create(b[0],b[1])),c=2;c<b.length;c++)d._addAll(a,b[c])},_startDrag:function(d,e,f){function g(){j||(x._fixIELayout(d,0),a.add(y.body,"div",{id:"mceEventBlocker","class":"mceEventBlocker "+(x.editor.settings.inlinepopups_skin||"clearlooks2"),style:{zIndex:x.zIndex+1}}),(tinymce.isIE6||tinymce.isIE&&!a.boxModel)&&a.setStyles("mceEventBlocker",{position:"absolute",left:o.x,top:o.y,width:o.w-2,height:o.h-2}),j=new b("mceEventBlocker"),j.update(),k=A.getXY(),l=A.getSize(),p=n.x+k.x-o.x,q=n.y+k.y-o.y,a.add(j.get(),"div",{id:"mcePlaceHolder","class":"mcePlaceHolder",style:{left:p,top:q,width:l.w,height:l.h}}),m=new b("mcePlaceHolder"))}{var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,y=a.doc,z=x.windows[d],A=z.element;A.getXY()}return n={x:0,y:0},o=a.getViewPort(),o.w-=2,o.h-=2,r=e.screenX,s=e.screenY,t=u=v=w=0,h=c.add(y,"mouseup",function(b){return c.remove(y,"mouseup",h),c.remove(y,"mousemove",i),j&&j.remove(),A.moveBy(t,u),A.resizeBy(v,w),l=A.getSize(),a.setStyles(d+"_ifr",{width:l.w-z.deltaWidth,height:l.h-z.deltaHeight}),x._fixIELayout(d,1),c.cancel(b)}),"Move"!=f&&g(),i=c.add(y,"mousemove",function(a){var b,d,e;switch(g(),b=a.screenX-r,d=a.screenY-s,f){case"ResizeW":t=b,v=0-b;break;case"ResizeE":v=b;break;case"ResizeN":case"ResizeNW":case"ResizeNE":"ResizeNW"==f?(t=b,v=0-b):"ResizeNE"==f&&(v=b),u=d,w=0-d;break;case"ResizeS":case"ResizeSW":case"ResizeSE":"ResizeSW"==f?(t=b,v=0-b):"ResizeSE"==f&&(v=b),w=d;break;case"mceMove":t=b,u=d}return v<(e=z.features.min_width-l.w)&&(0!==t&&(t+=v-e),v=e),w<(e=z.features.min_height-l.h)&&(0!==u&&(u+=w-e),w=e),v=Math.min(v,z.features.max_width-l.w),w=Math.min(w,z.features.max_height-l.h),t=Math.max(t,o.x-(p+o.x)),u=Math.max(u,o.y-(q+o.y)),t=Math.min(t,o.w+o.x-(p+l.w+o.x)),u=Math.min(u,o.h+o.y-(q+l.h+o.y)),t+u!==0&&(0>p+t&&(t=0),0>q+u&&(u=0),m.moveTo(p+t,q+u)),v+w!==0&&m.resizeTo(l.w+v,l.h+w),c.cancel(a)}),c.cancel(e)},resizeBy:function(a,b,c){var d=this.windows[c];d&&(d.element.resizeBy(a,b),d.iframeElement.resizeBy(a,b))},close:function(b,d){var e,f,d,g=this,h=a.doc;return d=g._findId(d||b),g.windows[d]?(g.count--,0==g.count&&(a.remove("mceModalBlocker"),a.setAttrib(a.doc.body,"aria-hidden","false"),g.editor.focus()),void((e=g.windows[d])&&(g.onClose.dispatch(g),c.remove(h,"mousedown",e.mousedownFunc),c.remove(h,"click",e.clickFunc),c.clear(d),c.clear(d+"_ifr"),a.setAttrib(d+"_ifr","src",'javascript:""'),e.element.remove(),delete g.windows[d],f=g._frontWindow(),f&&g.focus(f.id)))):void g.parent(b)},_frontWindow:function(){var a,b=0;return d(this.windows,function(c){c.zIndex>b&&(a=c,b=c.zIndex)}),a},setTitle:function(b,c){var d;b=this._findId(b),(d=a.get(b+"_title"))&&(d.innerHTML=a.encode(c))},alert:function(b,c){var d,e=this;d=e.open({title:e,type:"alert",button_func:function(a){c&&c.call(a||e,a),e.close(null,d.id)},content:a.encode(e.editor.getLang(b,b)),inline:1,width:400,height:130})},confirm:function(b,c){var d,e=this;d=e.open({title:e,type:"confirm",button_func:function(a){c&&c.call(a||e,a),e.close(null,d.id)},content:a.encode(e.editor.getLang(b,b)),inline:1,width:400,height:130})},_findId:function(b){var c=this;return"string"==typeof b?b:(d(c.windows,function(c){var d=a.get(c.id+"_ifr");return d&&b==d.contentWindow?(b=c.id,!1):void 0}),b)},_fixIELayout:function(b,c){var e,f;tinymce.isIE6&&(d(["n","s","w","e","nw","ne","sw","se"],function(d){var e=a.get(b+"_resize_"+d);a.setStyles(e,{width:c?e.clientWidth:"",height:c?e.clientHeight:"",cursor:a.getStyle(e,"cursor",1)}),a.setStyle(b+"_bottom","bottom","-1px"),e=0}),(e=this.windows[b])&&(e.element.hide(),e.element.show(),d(a.select("div,a",b),function(a){"none"!=a.currentStyle.backgroundImage&&(f=new Image,f.src=a.currentStyle.backgroundImage.replace(/url\(\"(.+)\"\)/,"$1"))}),a.get(b).style.filter=""))}}),tinymce.PluginManager.add("inlinepopups",tinymce.plugins.InlinePopups)}();
//# sourceMappingURL=editor_plugin_src.map