!function(){function a(a,b){return a.getParam(b,c[b])}var b=tinymce.each,c={paste_auto_cleanup_on_paste:!0,paste_enable_default_filters:!0,paste_block_drop:!1,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:!1,paste_remove_styles:!1,paste_remove_styles_if_webkit:!0,paste_convert_middot_lists:!0,paste_convert_headers_to_strong:!1,paste_dialog_width:"450",paste_dialog_height:"400",paste_max_consecutive_linebreaks:2,paste_text_use_dialog:!1,paste_text_sticky:!1,paste_text_sticky_default:!1,paste_text_notifyalways:!1,paste_text_linebreaktype:"combined",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.PastePlugin",{init:function(c,d){function e(b,d){var e,f=c.dom;g.onPreProcess.dispatch(g,b),b.node=f.create("div",0,b.content),tinymce.isGecko&&(e=c.selection.getRng(!0),e.startContainer==e.endContainer&&3==e.startContainer.nodeType&&1===b.node.childNodes.length&&/^(p|h[1-6]|pre)$/i.test(b.node.firstChild.nodeName)&&-1===b.content.indexOf("__MCE_ITEM__")&&f.remove(b.node.firstChild,!0)),g.onPostProcess.dispatch(g,b),b.content=c.serializer.serialize(b.node,{getInner:1,forced_root_block:""}),!d&&c.pasteAsPlainText?(g._insertPlainText(b.content),a(c,"paste_text_sticky")||(c.pasteAsPlainText=!1,c.controlManager.setActive("pastetext",!1))):g._insert(b.content)}function f(a){function d(a){a.preventDefault()}var f,g,h,i,j,k,l=c.selection,m=c.dom,n=c.getBody();if((a.clipboardData||m.doc.dataTransfer)&&(k=(a.clipboardData||m.doc.dataTransfer).getData("Text"),c.pasteAsPlainText))return a.preventDefault(),void e({content:m.encode(k).replace(/\r?\n/g,"<br />")});if(!m.get("_mcePaste"))return f=m.add(n,"div",{id:"_mcePaste","class":"mcePaste","data-mce-bogus":"1"},"﻿﻿"),j=n!=c.getDoc().body?m.getPos(c.selection.getStart(),n).y:n.scrollTop+m.getViewPort(c.getWin()).y,m.setStyles(f,{position:"absolute",left:tinymce.isGecko?-40:0,top:j-25,width:1,height:1,overflow:"hidden"}),tinymce.isIE?(i=l.getRng(),h=m.doc.body.createTextRange(),h.moveToElementText(f),h.execCommand("Paste"),m.remove(f),"﻿﻿"===f.innerHTML?(c.execCommand("mcePasteWord"),void a.preventDefault()):(l.setRng(i),l.setContent(""),setTimeout(function(){e({content:f.innerHTML})},0),tinymce.dom.Event.cancel(a))):(m.bind(c.getDoc(),"mousedown",d),m.bind(c.getDoc(),"keydown",d),g=c.selection.getRng(),f=f.firstChild,h=c.getDoc().createRange(),h.setStart(f,0),h.setEnd(f,2),l.setRng(h),window.setTimeout(function(){var a,f="";m.select("div.mcePaste > div.mcePaste").length?f="<p>"+m.encode(k).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>":(a=m.select("div.mcePaste"),b(a,function(a){var c=a.firstChild;c&&"DIV"==c.nodeName&&c.style.marginTop&&c.style.backgroundColor&&m.remove(c,1),b(m.select("span.Apple-style-span",a),function(a){m.remove(a,1)}),b(m.select("br[data-mce-bogus]",a),function(a){m.remove(a)}),"mcePaste"!=a.parentNode.className&&(f+=a.innerHTML)})),b(m.select("div.mcePaste"),function(a){m.remove(a)}),g&&l.setRng(g),e({content:f}),m.unbind(c.getDoc(),"mousedown",d),m.unbind(c.getDoc(),"keydown",d)},0),void 0)}var g=this;g.editor=c,g.url=d,g.onPreProcess=new tinymce.util.Dispatcher(g),g.onPostProcess=new tinymce.util.Dispatcher(g),g.onPreProcess.add(g._preProcess),g.onPostProcess.add(g._postProcess),g.onPreProcess.add(function(a,b){c.execCallback("paste_preprocess",a,b)}),g.onPostProcess.add(function(a,b){c.execCallback("paste_postprocess",a,b)}),c.onKeyDown.addToTop(function(a,b){return(tinymce.isMac?b.metaKey:b.ctrlKey)&&86==b.keyCode||b.shiftKey&&45==b.keyCode?!1:void 0}),c.pasteAsPlainText=a(c,"paste_text_sticky_default"),c.addCommand("mceInsertClipboardContent",function(a,b){e(b,!0)}),a(c,"paste_text_use_dialog")||c.addCommand("mcePasteText",function(){var b=tinymce.util.Cookie;c.pasteAsPlainText=!c.pasteAsPlainText,c.controlManager.setActive("pastetext",c.pasteAsPlainText),c.pasteAsPlainText&&!b.get("tinymcePasteText")&&(c.windowManager.alert(a(c,"paste_text_sticky")?c.translate("paste.plaintext_mode_sticky"):c.translate("paste.plaintext_mode")),a(c,"paste_text_notifyalways")||b.set("tinymcePasteText","1",new Date((new Date).getFullYear()+1,12,31)))}),c.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"}),c.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"}),a(c,"paste_auto_cleanup_on_paste")&&(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?c.onKeyDown.addToTop(function(a,b){((tinymce.isMac?b.metaKey:b.ctrlKey)&&86==b.keyCode||b.shiftKey&&45==b.keyCode)&&f(b)}):c.onPaste.addToTop(function(a,b){return f(b)})),c.onInit.add(function(){c.controlManager.setActive("pastetext",c.pasteAsPlainText),a(c,"paste_block_drop")&&c.dom.bind(c.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(a){return a.preventDefault(),a.stopPropagation(),!1})}),g._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(c,d){function e(a){b(a,function(a){j=a.constructor==RegExp?j.replace(a,""):j.replace(a[0],a[1])})}function f(a,b){if("all"===h)return"";var c=k(l(b.replace(/^(["'])(.*)\1$/,"$2")," "),function(a){return/^(?!mso)/i.test(a)});return c.length?' class="'+c.join(" ")+'"':""}var g,h,i=this.editor,j=d.content,k=tinymce.grep,l=tinymce.explode,m=tinymce.trim;if(0!=i.settings.paste_enable_default_filters){if(tinymce.isIE&&document.documentMode>=9&&/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(d.content)&&(e([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]),e([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])),/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(j)||d.wordContent){d.wordContent=!0,e([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]),a(i,"paste_convert_headers_to_strong")&&(j=j.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")),a(i,"paste_convert_middot_lists")&&e([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]),e([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "]]);do g=j.length,j=j.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1");while(g!=j.length);0==a(i,"paste_retain_style_properties").replace(/^none$/i,"").length?j=j.replace(/<\/?span[^>]*>/gi,""):e([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return b.length>0?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join(" "):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(a,c,d){var e=[],f=0,g=l(m(d).replace(/&quot;/gi,"'"),";");return b(g,function(a){function b(a){return a+("0"!==a&&/\d$/.test(a))?"px":""}var c,d,g=l(a,":");if(2==g.length){switch(c=g[0].toLowerCase(),d=g[1].toLowerCase(),c){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":return void(e[f++]=c.replace(/^mso-|-alt$/g,"")+":"+b(d));case"horiz-align":return void(e[f++]="text-align:"+d);case"vert-align":return void(e[f++]="vertical-align:"+d);case"font-color":case"mso-foreground":return void(e[f++]="color:"+d);case"mso-background":case"mso-highlight":return void(e[f++]="background:"+d);case"mso-default-height":return void(e[f++]="min-height:"+b(d));case"mso-default-width":return void(e[f++]="min-width:"+b(d));case"mso-padding-between-alt":return void(e[f++]="border-collapse:separate;border-spacing:"+b(d));case"text-line-through":return void(("single"==d||"double"==d)&&(e[f++]="text-decoration:line-through"));case"mso-zero-height":return void("yes"==d&&(e[f++]="display:none"))}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(c))return;e[f++]=c+":"+g[1]}}),f>0?c+' style="'+e.join(";")+'"':c}]])}a(i,"paste_convert_headers_to_strong")&&e([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]),e([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]),h=a(i,"paste_strip_class_attributes"),"none"!==h&&(j=j.replace(/ class="([^"]+)"/gi,f),j=j.replace(/ class=([\-\w]+)/gi,f)),a(i,"paste_remove_spans")&&(j=j.replace(/<\/?span[^>]*>/gi,"")),d.content=j}},_postProcess:function(c,d){var e,f=this,g=f.editor,h=g.dom;0!=g.settings.paste_enable_default_filters&&(d.wordContent&&(b(h.select("a",d.node),function(a){a.href&&-1==a.href.indexOf("#_Toc")||h.remove(a,1)}),a(g,"paste_convert_middot_lists")&&f._convertLists(c,d),e=a(g,"paste_retain_style_properties"),tinymce.is(e,"string")&&"all"!==e&&"*"!==e&&(e=tinymce.explode(e.replace(/^none$/i,"")),b(h.select("*",d.node),function(a){var b,c,d,f={},g=0;if(e)for(b=0;b<e.length;b++)c=e[b],d=h.getStyle(a,c),d&&(f[c]=d,g++);h.setAttrib(a,"style",""),e&&g>0?h.setStyles(a,f):"SPAN"!=a.nodeName||a.className||h.remove(a,!0)}))),a(g,"paste_remove_styles")||a(g,"paste_remove_styles_if_webkit")&&tinymce.isWebKit?b(h.select("*[style]",d.node),function(a){a.removeAttribute("style"),a.removeAttribute("data-mce-style")}):tinymce.isWebKit&&b(h.select("*",d.node),function(a){a.removeAttribute("data-mce-style")}))},_convertLists:function(a,c){var d,e,f,g,h,i=a.editor.dom,j=-1,k=[];b(i.select("p",c.node),function(a){var c,h,l,m,n,o="";for(c=a.firstChild;c&&3==c.nodeType;c=c.nextSibling)o+=c.nodeValue;o=a.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g," "),/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(o)&&(h="ul"),/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(o)&&(h="ol"),h?(f=parseFloat(a.style.marginLeft||0),f>j&&k.push(f),d&&h==g?f>j?d=e.appendChild(i.create(h)):j>f&&(m=tinymce.inArray(k,f),n=i.getParents(d.parentNode,h),d=n[n.length-1-m]||d):(d=i.create(h),i.insertAfter(d,a)),b(i.select("span",a),function(a){var b=a.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");"ul"==h&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(b)?i.remove(a):/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(b)&&i.remove(a)}),l=a.innerHTML,l="ul"==h?a.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):a.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,""),e=d.appendChild(i.create("li",0,l)),i.remove(a),j=f,g=h):d=j=0}),h=c.node.innerHTML,-1!=h.indexOf("__MCE_ITEM__")&&(c.node.innerHTML=h.replace(/__MCE_ITEM__/g,""))},_insert:function(a,b){var c=this.editor,d=c.selection.getRng();c.selection.isCollapsed()||d.startContainer==d.endContainer||c.getDoc().execCommand("Delete",!1,null),c.execCommand("mceInsertContent",!1,a,{skip_undo:b})},_insertPlainText:function(c){function d(a){b(a,function(a){c=a.constructor==RegExp?c.replace(a,""):c.replace(a[0],a[1])})}var e=this.editor,f=a(e,"paste_text_linebreaktype"),g=a(e,"paste_text_replacements"),h=tinymce.is;if("string"==typeof c&&c.length>0){d(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(c)?[/[\n\r]+/g]:[/\r+/g]),d([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"	"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"]]);var i=Number(a(e,"paste_max_consecutive_linebreaks"));if(i>-1){for(var j=new RegExp("\n{"+(i+1)+",}","g"),k="";k.length<i;)k+="\n";d([[j,k]])}c=e.dom.decode(tinymce.html.Entities.encodeRaw(c)),h(g,"array")?d(g):h(g,"string")&&d(new RegExp(g,"gi")),d("none"==f?[[/\n+/g," "]]:"br"==f?[[/\n/g,"<br />"]]:"p"==f?[[/\n+/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"]]:[[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]),e.execCommand("mceInsertContent",!1,c)}},_legacySupport:function(){var b=this,c=b.editor;c.addCommand("mcePasteWord",function(){c.windowManager.open({file:b.url+"/pasteword.htm",width:parseInt(a(c,"paste_dialog_width")),height:parseInt(a(c,"paste_dialog_height")),inline:1})}),a(c,"paste_text_use_dialog")&&c.addCommand("mcePasteText",function(){c.windowManager.open({file:b.url+"/pastetext.htm",width:parseInt(a(c,"paste_dialog_width")),height:parseInt(a(c,"paste_dialog_height")),inline:1})}),c.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}}),tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)}();
//# sourceMappingURL=editor_plugin_src.map